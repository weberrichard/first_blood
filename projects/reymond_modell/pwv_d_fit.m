clear;

meas=[3.320818030695481, 8.481076274790274
3.7806007654540537, 9.080040205667451
4.210925116944368, 12.787636757258284
4.728116905709978, 6.560722155642324
4.976866277496425, 6.97255190010438
6.232373294158581, 8.778884292728186
9.487060733753431, 7.587714075849538
10.593420187884176, 9.188147059960569
11.365090656048245, 5.6857927088568445
11.350941353848532, 4.974191054238991
14.695790002706152, 5.178095643097384
14.67598097962655, 7.181853326632389
19.452414273011946, 5.268759423203308
29.142598677852085, 6.873197510341361
29.13837708276955, 5.16908029535702
29.136382263115166, 4.363838094869912
];

x = meas(:,1)/1000;
y = meas(:,2);

fitted=[3.0387598097962663,9.623574438473732
3.805234468627982,9.023845053543123
4.695759075269649,8.498944601229367
5.932964781381683,7.917647968454014
7.6904008968956585,7.33602659759539
9.027440368036492,7.054293114779449
10.760613909614566,6.678679398461361
13.06365639618046,6.340163142227549
15.936428654269916,5.9825646576719365
18.85888583910001,5.681114934085901
21.80625507403255,5.435829435187692
24.704217729152973,5.24675455213206
29.113186685738583,5.000556693857037];

x_fit = fitted(:,1)/1000;
y_fit = fitted(:,2);

% fitting to original a*x^c+b
%        a =       0.915  (-14.28, 16.11)
%        b =     -0.3731  (-2.611, 1.865)
%        c =        1.85  (-29.35, 33.05)

% fitting to fitted a*x^c+b, R2=1
%        a =       1.931  (1.559, 2.304)
%        b =     -0.2807  (-0.3039, -0.2575)
%        c =     -0.2062  (-0.8024, 0.39)

a_m1 = 0.915;
b_m1 = -0.3731;
c_m1 = 1.85;
y_fit_m1 = a_m1*x.^b_m1 + c_m1;

a_m2 = 1.931;
b_m2 = -0.2807;
c_m2 = -0.2062;
y_fit_m2 = a_m2*x_fit.^b_m2 + c_m2;

figure;
plot(x,y,'x');
hold on; grid on;
plot(x_fit,y_fit);
plot(x,y_fit_m1);
plot(x_fit,y_fit_m2);
legend('orig','fit','fit_m1','fit_m2');

